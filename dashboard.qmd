---
format: dashboard
editor_options: 
  chunk_output_type: console
execute:
  echo: false
---

```{r setup}
options(repos = "https://cran.r-project.org/")  # Set CRAN mirror

# Load necessary libraries
library(dplyr)
library(ggplot2)

# Load the data
data <- read.csv("data/Data_Breaches_LATEST.csv")

# Aggregate sector categories
data$sector <- ifelse(data$sector %in% c("academic", "finance", "government", "health", "military", "tech"), data$sector, "other")


# Aggregate method categories
data$method <- ifelse(data$method %in% c("hacked", "inside job", "lost device", "poor security"), data$method, "other")
```

## Row {height=70%}
```{r}

### Plot 1: Line chart for Number of Breaches Over Time by Sector
### Load necessary libraries
library(dplyr)
library(plotly)

### Plot 1: Line chart for Number of Breaches Over Time by Sector
data_agg1 <- data %>%
  group_by(year, sector) %>%
  summarise(count = n()) %>%
  arrange(year, sector) %>%
  ungroup()

line_chart <- plot_ly(
  data_agg1,
  x = ~year,
  y = ~count,
  color = ~sector,
  type = 'scatter',
  mode = 'lines+markers',
  colors = rainbow(length(unique(data_agg1$sector))),
  title = "Number of Breaches Over Time by Sector",
  xaxis = list(title = "Year"),
  yaxis = list(title = "Count"),
  legend = list(orientation = "h", x = 0.3, y = 1.1),
  margin = list(l = 50, r = 50, b = 100, t = 100)
)
line_chart



```




```{r}
#| title: Chart 3
#| 


```


### Column
```{r}

### Plot 4: Your third time analysis plot
# Your code here




```





